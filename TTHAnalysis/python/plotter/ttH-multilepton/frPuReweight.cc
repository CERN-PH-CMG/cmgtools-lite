float _puwMu3_PFJet40[60] = { 1.0, 0.00766228426524, 0.0586435301485, 0.167851984571, 0.292419150265, 0.47618232406, 0.731849571975, 0.927540840569, 1.04462126486, 1.15799038167, 1.22765815609, 1.31774788689, 1.3815370363, 1.43692804986, 1.45342355529, 1.46135215533, 1.45937332615, 1.43817936853, 1.44013326009, 1.4189391409, 1.40275049244, 1.33300221926, 1.32055765472, 1.29341277833, 1.22020933758, 1.17887141414, 1.09434680398, 1.03603326139, 1.0033056959, 0.931728440714, 0.930002275282, 0.892636045684, 0.835174242195, 0.806753383703, 0.810122270643, 0.716398338909, 0.682841535946, 0.630437358627, 0.557418457996, 0.552569094332, 0.497000829561, 0.473474249457, 0.427296393404, 0.367419896516, 0.342202036295, 0.317439822633, 0.29121674402, 0.266285849973, 0.231325752562, 0.181565302334, 0.132363201395, 0.20445656791, 0.1177440021, 0.12180654849, 0.10596768134, 0.162043731838, 0.146950083438, 0.0648464301141, 0.112265289929, 0.057038811541 };
float puwMu3_PFJet40(int nVert) { return _puwMu3_PFJet40[std::min(nVert,59)] * (106415.0/567529800.352); }

float _puwMu8[60] = { 1.0, 0.00375233300155, 0.0587694049172, 0.129750807629, 0.271609315905, 0.551750855896, 0.721037801572, 1.01814771798, 0.995465633828, 1.11617209489, 1.13941023763, 1.34502118371, 1.29796476545, 1.25987930612, 1.31191971413, 1.27831730238, 1.29003549789, 1.32363666584, 1.33609072336, 1.29241626706, 1.26326459829, 1.23033723336, 1.24299560984, 1.16720753048, 1.11223734072, 1.08385991568, 1.08404014037, 1.06505473407, 1.05762822758, 1.00039086935, 1.02305082896, 0.98227254379, 0.951747398073, 0.909837622844, 0.901192463081, 0.911365739144, 0.880411181419, 0.850074969413, 0.814453468709, 0.808310489793, 0.740668068037, 0.75101198661, 0.627764773643, 0.626830844477, 0.562517028286, 0.470831590196, 0.477787599348, 0.414791719871, 0.340054306465, 0.347476630406, 0.269439209908, 0.34212880281, 0.253184684468, 0.198429583581, 0.205329280163, 0.180354370058, 0.165878763681, 0.100968348555, 0.206907316713, 0.0887155813073 };
float puwMu8(int nVert) { return _puwMu8[std::min(nVert,59)] * (85686.0/803884500.164); }

float _puwMu17[60] = { 1.0, 0.00712094202047, 0.0739834796503, 0.213310405026, 0.36976138282, 0.575162494299, 0.750373877856, 0.932984169178, 1.10591185677, 1.13368433566, 1.14897745442, 1.25103914333, 1.27736569694, 1.27379786868, 1.34003158417, 1.33757283101, 1.34031312366, 1.35673792276, 1.33629502146, 1.32646031025, 1.32508863219, 1.31867042324, 1.25454316364, 1.22075032508, 1.17899105474, 1.16295862575, 1.08268900413, 1.07900123562, 1.05025219428, 1.02532882974, 0.957651940196, 0.931760693617, 0.91544891929, 0.878268237753, 0.896169799875, 0.842309369016, 0.811545662292, 0.76230151171, 0.780980772958, 0.710504873826, 0.665170513299, 0.5927336972, 0.56081757048, 0.515622222995, 0.46766879288, 0.39776814903, 0.384208433401, 0.328151047699, 0.307207669765, 0.265408561756, 0.262697526325, 0.21663906328, 0.208163370388, 0.196497235176, 0.169600414723, 0.147222879296, 0.145135990052, 0.111223972955, 0.0915786306637, 0.0751816689203 };
float puwMu17(int nVert) { return _puwMu17[std::min(nVert,59)] * (367451.0/204252278.255); }

float _puwMu20[60] = { 1.0, 0.0021584929323, 0.0341612501839, 0.123108223431, 0.245282952851, 0.433435567395, 0.656044549546, 0.822589364154, 0.996105997583, 1.07415435322, 1.16604975035, 1.27447641276, 1.3344755107, 1.41915627425, 1.47744392908, 1.51515234564, 1.57817660068, 1.59675811585, 1.61303006157, 1.61326204024, 1.60625676487, 1.57592957625, 1.51204937518, 1.45573154422, 1.38962187489, 1.32166480977, 1.22432775462, 1.13232659163, 1.04635301768, 0.964037045554, 0.856956976288, 0.765087574455, 0.692473846099, 0.60541240776, 0.554370610743, 0.45990127277, 0.412768544996, 0.335008368847, 0.291467939169, 0.251756768579, 0.19918148062, 0.167311566485, 0.141836716833, 0.117582404862, 0.0964943370881, 0.0785306681313, 0.0679880760036, 0.0622204134386, 0.0496549909973, 0.044203506185, 0.0371059567469, 0.0287912456706, 0.0286257419323, 0.0218103169494, 0.0181120838999, 0.0160011523894, 0.0160054003294, 0.0144188685205, 0.0133397403999, 0.00697490771716 };
float puwMu20(int nVert) { return _puwMu20[std::min(nVert,59)] * (2314398.0/152503423.072); }

float _puwMu27[60] = { 1.0, 0.00515107066812, 0.0700157998964, 0.204997312783, 0.348537074486, 0.563052645381, 0.811599101988, 0.893435400616, 1.06798699344, 1.10099255329, 1.22495047316, 1.23409535728, 1.29902632519, 1.36102521335, 1.37880796348, 1.35641036045, 1.40067171511, 1.39579337638, 1.39718998311, 1.3772118159, 1.36663051052, 1.33697157763, 1.30130924739, 1.24858233561, 1.21454885607, 1.20159021788, 1.12661871337, 1.08240514867, 1.04812800471, 1.01037536692, 0.971091959172, 0.901474678157, 0.899273164459, 0.858756876204, 0.847873081182, 0.79054468208, 0.743326126463, 0.709887063481, 0.667746589619, 0.62892613669, 0.566617369454, 0.545886383678, 0.488148028056, 0.461257192338, 0.399547096435, 0.347866593364, 0.326715487815, 0.309833488266, 0.271455246947, 0.262409734498, 0.224613502322, 0.199112956565, 0.206343520806, 0.147496307444, 0.157599903885, 0.146155037105, 0.131170123435, 0.107144280792, 0.110858004791, 0.0623934028374 };
float puwMu27(int nVert) { return _puwMu27[std::min(nVert,59)] * (438559.0/91912877.4515); }

float _puwEle8[60] = { 1.0, 0.0114147073053, 0.0928071895054, 0.189635813336, 0.622849301072, 0.912428173636, 1.26130819484, 1.47724112874, 1.88425982522, 1.84246235814, 1.89691224887, 1.70434418482, 1.84319905063, 1.71693361114, 1.61436913045, 1.54119226527, 1.50893766037, 1.51578764223, 1.40413940761, 1.35879455272, 1.32569611131, 1.21423097778, 1.15197182731, 1.1059879549, 0.979869249717, 0.924883690195, 0.898533036001, 0.888863739606, 0.834654706868, 0.790780347176, 0.697773359523, 0.668928730562, 0.715103124065, 0.588130416622, 0.531713509296, 0.513062690227, 0.487611033332, 0.445879729648, 0.455330294688, 0.389139839314, 0.37453816249, 0.327006411971, 0.331338410667, 0.290724732241, 0.213691088807, 0.182695314063, 0.242793995316, 0.204318659651, 0.183227755323, 0.114058381924, 0.14189824817, 0.143423356608, 0.0897238837625, 0.095509204325, 0.0455348332608, 0.134903794417, 0.102459680824, 0.0371852348926, 0.137868602868, 0.0567773398514 };
float puwEle8(int nVert) { return _puwEle8[std::min(nVert,59)] * (29354.0/265789226.625); }

float _puwEle17[60] = { 1.0, 0.00639619609882, 0.0771220221394, 0.205969665964, 0.405569387616, 0.579053555301, 0.719375073162, 1.21059258649, 1.18968297842, 1.2888285813, 1.37871225923, 1.31531049881, 1.48226862441, 1.45828501291, 1.40846779715, 1.35216547874, 1.32919876114, 1.48398210141, 1.37903444338, 1.41032404327, 1.43061548936, 1.26253520862, 1.19393553595, 1.1566376093, 1.13391811037, 1.11451731914, 1.01231500342, 1.00640140575, 1.00187238453, 0.917201387155, 0.873795806054, 0.843631209016, 0.769294242694, 0.777196767101, 0.722763613226, 0.622438741868, 0.643169310054, 0.529619674202, 0.533857516633, 0.528299413689, 0.504754350243, 0.419911691901, 0.425576820899, 0.409313263884, 0.347522826269, 0.31547793322, 0.283315981697, 0.297218502947, 0.231052187894, 0.236091604681, 0.248331700695, 0.174425101715, 0.135757102544, 0.147503168311, 0.113538310309, 0.154448379917, 0.118425450561, 0.230831705642, 0.132396621383, 0.0559773171131 };
float puwEle17(int nVert) { return _puwEle17[std::min(nVert,59)] * (154999.0/189322365.885); }

float _puwEle23[60] = { 1.0, 0.00563857616479, 0.131168472496, 0.281907419539, 0.536667863132, 0.83663747211, 0.964623527281, 1.41405839456, 1.39838690792, 1.39953361371, 1.60233871218, 1.39125015691, 1.53964332292, 1.47951182891, 1.4502454474, 1.36132629742, 1.32604690236, 1.46061704539, 1.35539701791, 1.36289485713, 1.43375187399, 1.24386457365, 1.15151594231, 1.16446935742, 1.11706406187, 1.13138111462, 1.01500148483, 0.996093240813, 0.972565958632, 0.931566187159, 0.864105485391, 0.854807205728, 0.76186247727, 0.769019793894, 0.684557002661, 0.623618082491, 0.597846789384, 0.513410189847, 0.506972078831, 0.525190408881, 0.477474471073, 0.412098006874, 0.393117991162, 0.38141110644, 0.344455655716, 0.278270684306, 0.263664604397, 0.31149487511, 0.201389987498, 0.223081846735, 0.234308847677, 0.15560447234, 0.117754865037, 0.124364990525, 0.100377338625, 0.139511920573, 0.103527595414, 0.202616361985, 0.105465673412, 0.0530667010718 };
float puwEle23(int nVert) { return _puwEle23[std::min(nVert,59)] * (126377.0/143425491.144); }

void frPuReweight() {}

float _coneptwMuX_OR_ptvals[6] = { 15.0, 20.0, 32.0, 45.0, 65.0, 100.0 };
float _coneptwMuX_OR_wvals[180] = { 2.32250446369e-06, 1.76660305214e-05, 5.05758003976e-05, 0.000169846714345, 0.000177730478881, 0.000202467254081, 0.000236024915182, 0.000225431630213, 0.000220595405355, 0.000221533464798, 0.000204442973778, 0.000214467495485, 0.00018506863982, 0.00017204392809, 0.000144712627695, 0.000149337675509, 0.000135439267814, 0.000115169762559, 8.98341491473e-05, 0.000106830413873, 7.54111245984e-05, 8.6407046536e-05, 7.42459741425e-05, 5.28076561892e-05, 3.89162391022e-05, 3.0045707467e-05, 2.04863392154e-05, 1.54268161417e-05, 2.56760876248e-05, 1.62074423818e-05, 7.86720603898e-07, 8.05051858827e-06, 6.77905104656e-05, 0.000121663606798, 0.000129809048378, 0.000173288985025, 0.000179483544029, 0.00018677970695, 0.00017754537396, 0.00018693697811, 0.000171810829442, 0.000164499734721, 0.000152375368817, 0.00014491408931, 0.000135586822734, 0.000135498229142, 0.000121912272739, 0.000109824455371, 0.000114356126475, 9.47172296855e-05, 8.17210286109e-05, 8.58828497251e-05, 5.08478605652e-05, 5.11198745745e-05, 5.96356493731e-05, 3.28955609063e-05, 3.30167620435e-05, 1.1514594278e-05, 1.54887481288e-05, 1.7226439858e-05, 2.64185952102e-07, 1.51284102113e-05, 7.09517711353e-05, 0.000114916777717, 0.000162797536135, 0.000191268951728, 0.00020357340424, 0.000201813760554, 0.000201982636228, 0.000198689006918, 0.000188568756628, 0.000183936879415, 0.000164555377897, 0.000151997595386, 0.000154591449631, 0.000140605784646, 0.000130270589553, 0.000117721365394, 0.000121486091787, 0.000104573623785, 9.22580374333e-05, 7.17689469597e-05, 5.86375104183e-05, 5.60972921866e-05, 3.70955709736e-05, 4.49753987318e-05, 1.69642673238e-05, 3.23087782434e-05, 1.50145591234e-05, 2.63403153042e-05, 3.91854395042e-05, 0.00124998699368, 0.00625475334311, 0.0131110637565, 0.0184596628153, 0.0207649386689, 0.0229916751837, 0.0247049149948, 0.0265411502572, 0.0267169149659, 0.0259529428167, 0.0241150807971, 0.0222785034704, 0.0197937623434, 0.016636600279, 0.0138045339196, 0.0113649528352, 0.0092389300992, 0.00700732440057, 0.0054140018748, 0.003821790608, 0.00282198762713, 0.00214806900178, 0.00151620818518, 0.00116693221954, 0.000956560480621, 0.000728608103233, 0.000474124337985, 0.000449882166834, 0.000387410554764, 6.35686252596e-05, 0.00182831193939, 0.00827228725797, 0.0163585627679, 0.0218950050829, 0.0261128462859, 0.0290271052794, 0.0307651996307, 0.0322261201893, 0.0326157807153, 0.0326081902952, 0.0301457927199, 0.0276238068203, 0.024474398491, 0.0219754302901, 0.0176522981775, 0.0151089584816, 0.0127533616938, 0.0102241903733, 0.00812164103752, 0.00640242848237, 0.00500827875446, 0.00372764435133, 0.00316575036036, 0.00250019336063, 0.00183878745249, 0.00158395840312, 0.00128363899872, 0.00103704184462, 0.000676388084342, 7.26877542234e-05, 0.00211745627861, 0.00780929456669, 0.0155197522079, 0.0224701448612, 0.024875289747, 0.0282243506227, 0.0304104443533, 0.031037401209, 0.0315024331249, 0.0307226674661, 0.0296558453621, 0.0267584072361, 0.0230640204549, 0.0214321193857, 0.0178677671564, 0.015054585952, 0.0127606754391, 0.00991495178156, 0.00770143952416, 0.00637664786939, 0.00480171782999, 0.00347731108747, 0.00266393738585, 0.0024720655404, 0.00194318990216, 0.0015014421838, 0.00108535269123, 0.000838743338809, 0.000746705414693 };
float coneptwMuX_OR(float conept, int nVert) {
    int vtxbin = std::min(nVert/2, 30-1);
    for (unsigned int i = 0; i < 6; ++i) {
        if (conept < _coneptwMuX_OR_ptvals[i]) return _coneptwMuX_OR_wvals[i*30 + vtxbin];
    }
    return 0.;
}

float _coneptwEleX_OR_ptvals[5] = { 25.0, 35.0, 45.0, 65.0, 100.0 };
float _coneptwEleX_OR_wvals[150] = { 1.35205727031e-06, 1.20890321514e-05, 7.39693924829e-05, 0.000139923469116, 0.00020843343047, 0.000172659236056, 0.000176220892112, 0.000171707756515, 0.000169591538988, 0.000149816018535, 0.000128193237766, 0.000119484215246, 0.000102192675863, 9.55187560271e-05, 8.79427625692e-05, 6.64090821552e-05, 7.68470953844e-05, 6.3163630112e-05, 6.34055189596e-05, 4.05090213936e-05, 4.03584294717e-05, 2.92332379278e-05, 2.02642474033e-05, 2.28594040881e-05, 1.33153389701e-05, 1.54166915879e-05, 1.70129071587e-05, 1.592628857e-05, 7.40318034505e-06, 1.43165533553e-05, 4.34964117516e-06, 0.000137389250725, 0.000564070108023, 0.00112792419209, 0.00122089207801, 0.0012529816261, 0.00142855524985, 0.00115288521176, 0.00119880110587, 0.0012504397077, 0.00117992275346, 0.00100469983233, 0.000951885796378, 0.000849123207482, 0.000831621260354, 0.000733904080409, 0.000652669805151, 0.00054756131295, 0.000435401598224, 0.000426615332144, 0.000369851625941, 0.000344576312727, 0.000274704946574, 0.000225894148006, 0.000155345522673, 0.000185128617587, 0.000121287843133, 0.000100354867875, 0.0001038416351, 0.000109206538898, 1.39556500792e-05, 0.000168410654485, 0.000826139422366, 0.0015699517604, 0.00166860513846, 0.00185550403447, 0.00159071319519, 0.00150712045418, 0.00145492264549, 0.0013661072259, 0.00139800725036, 0.00107174688488, 0.00112446367859, 0.00104797398974, 0.000976201824997, 0.000878845497447, 0.000734232273152, 0.000670308383988, 0.000519023136729, 0.000485552313125, 0.000405515536311, 0.000329634124726, 0.000303749662681, 0.000263138446714, 0.000212317803003, 0.000195014944942, 7.43295680666e-05, 0.000140722582244, 0.000166064695758, 6.3382558876e-05, 9.20780558706e-06, 0.000307960583173, 0.00115089483761, 0.00158523452431, 0.00187924047485, 0.00170993776188, 0.00172685642645, 0.00159776643937, 0.00152476713513, 0.00147655320215, 0.00136357005356, 0.00131246249626, 0.00117967658813, 0.00104005243995, 0.000972262146468, 0.00086091109423, 0.000787192731063, 0.000599226671939, 0.000622409046734, 0.000529559040503, 0.000437272656603, 0.000437371642541, 0.000282333817994, 0.00026420136252, 0.000193800774957, 0.000214203463269, 0.000133565490857, 0.000105879599195, 0.000161652594385, 0.000126701954884, 9.70672286963e-06, 0.000270757642528, 0.0010321293618, 0.00165393192245, 0.00196205430222, 0.00220977977096, 0.00199433681103, 0.00184508566189, 0.00185683926551, 0.00165871501049, 0.00155899948237, 0.00146645922649, 0.00135944357574, 0.00117566580626, 0.00114880285837, 0.000992278536044, 0.000920408616287, 0.000770927700881, 0.000716164541679, 0.000702686888116, 0.000479641263156, 0.000363298636089, 0.000396975432621, 0.00022973144813, 0.000272735647027, 0.000156087961328, 0.000152758182093, 0.0001404785325, 5.90909760326e-05, 2.82170499175e-05 };
float coneptwEleX_OR(float conept, int nVert) {
    int vtxbin = std::min(nVert/2, 30-1);
    for (unsigned int i = 0; i < 5; ++i) {
        if (conept < _coneptwEleX_OR_ptvals[i]) return _coneptwEleX_OR_wvals[i*30 + vtxbin];
    }
    return 0.;
}
